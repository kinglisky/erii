<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>小修小补 • 芊野</title><meta name="description" content="小修小补 - kinglisky"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/blog/favicon.svg"><link rel="stylesheet" href="https://unpkg.com/nanoreset/nanoreset.min.css"><link rel="stylesheet" href="/blog/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/blog/atom.xml" title="芊野"></head><body><div class="wrap" id="barba-wrapper"><header><h1 class="branding"><a href="/blog/" title="芊野"><img class="logo-image" src="/blog/logo.svg" alt="logo"></a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link no-barba" href="/blog/" target="_self">HOME</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/blog/archives" target="_self">ARCHIVES</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/blog/about" target="_self">ABOUT</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="https://github.com/kinglisky" target="_blank">GITHUB</a></li></ul></header><div class="barba-container"><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">小修小补</h1><div class="post-info"><a></a>2018-04-10</div><div class="post-content"><p><img src="https://i.loli.net/2018/04/10/5accc5b184296.jpg" alt="sky"></p>
<p>很久没有归纳梳理过学过的知识点，作为一个笔记陆续记下来。</p>
<a id="more"></a>
<h2 id="RESTful-幂等性"><a href="#RESTful-幂等性" class="headerlink" title="RESTful 幂等性"></a>RESTful 幂等性</h2><p><strong>幂等与安全的方法</strong></p>
<blockquote>
<p>安全方法是指不修改资源的 HTTP 方法。譬如，当使用 GET 或者 HEAD 作为资源 URL，都必须不去改变资源。然而，这并不全准确。意思是：它不改变资源的<strong>表示形式</strong>。对于安全方法，它仍然可能改变服务器上的内容或资源，但这必须不导致不同的表现形式。</p>
</blockquote>
<p>安全方法和幂等操作并没有直接联系，例如 GET 是个安全方法：</p>
<blockquote>
<p>GET /tickets/12/delete</p>
</blockquote>
<p>这样的 GET 操作实际会影响到资源状态，当无论你调用多少次，始终只会删除一个资源，所以这个操作是幂等的，RESTful 幂等性关注的多次操作影响是不是一直的。</p>
<p>简单理解：RESTful 的幂等操作，是指无论操作多少次每次操作的资源结果都是相同。</p>
<p><strong>GET</strong></p>
<p>GET 是个幂等操作，GET 的操作无论调用多少次都不会影响资源本身。</p>
<p><strong>POST</strong></p>
<p>POST 是典型的非幂等操作，POST 典型的操作就是新增一个资源项目，每次调用的都会产生的新的资源。</p>
<p><strong>PUT</strong></p>
<p>PUT 呢？例如下面这个操作</p>
<blockquote>
<p>PUT     /tickets/12    # 更新 ticket 12</p>
</blockquote>
<p>因为它直接把实体部分的数据替换到服务器的资源，我们多次调用它，只会产生一次影响，但是有相同结果的 HTTP 方法，所以满足幂等性。</p>
<p><strong>PATCH</strong></p>
<p>PATCH 呢？感觉上和 PUT 是一样的，但其实不然。</p>
<p>PATCH 方法是非幂等的。POST 方法和 PUT 方法可能比较好理解，但是 PATCH 方法只是更新部分资源，怎么是非幂等的呢?</p>
<p>因为，PATCH 提供的实体则需要根据程序或其它协议的定义，解析后在服务器上执行，以此来修改服务器上的资源。换句话说，PATCH 请求是会执行某个程序的，如果重复提交，程序可能执行多次，对服务器上的资源就可能造成额外的影响，这就可以解释它为什么是非幂等的了。</p>
<p>可能你还不能理解这点。我们举个例子</p>
<blockquote>
<p>PATCH   /tickets/12    # 更新 ticket 12</p>
</blockquote>
<p>此时，我们服务端对方法的处理是，当调用一次方法，更新部分字段，将这条ticket记录的操作记录加一，这次，每次调用的资源是不是变了呢，所以它是有可能是非幂等的操作。</p>
<p><strong>DELETE</strong></p>
<p>DELETE 方法用于删除资源，会将资源删除。</p>
<blockquote>
<p>DELETE /tickets/12 # 删除 ticekt 12</p>
</blockquote>
<p>调用一次和多次对资源产生影响是相同的，所以也满足幂等性。</p>
<p>参考链接：</p>
<ul>
<li><a href="https://sofish.github.io/restcookbook/" target="_blank" rel="noopener">RESTful 手册</a></li>
<li><a href="http://blog.720ui.com/2016/restful_idempotent/" target="_blank" rel="noopener">RESTful 幂等性</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a class="next" href="/blog/2018/03/28/为github-pages加上免费安全证书/">NEXT</a></div><div class="copyright"><p>&copy; 2018 <a href="https://nlush.com">芊野</a><br>Powered by <a href="https://hexo.io/" rel="noreferrer" target="_blank">Hexo</a></p></div></footer></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/barba.js/1.0.0/barba.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
    Barba.Pjax.start()
})</script></body></html>